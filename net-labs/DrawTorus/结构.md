
## widget.h
```
class Widget : public QOpenGLWidget
{
    // 在声明的最顶部使用 Q_OBJECT，这样才能使用槽和信号
    Q_OBJECT
public:
    Widget(QWidget *parent = 0);
    ~Widget();

    /*重载的3个函数*/
protected:
    void initializeGL() override;
    void resizeGL(int w, int h) override;
    void paintGL() override;

private:
    // 定时器
    // 渲染器
    // 【投影矩阵】
    // 用来设置【变换矩阵】的偏移角
    // 摄像机（一个3D向量而已）    
    
private slots:
    // slot：槽函数，作为定时触发的函数
    
};
```


## widget.cpp

```
Widget::Widget(QWidget *parent) : QOpenGLWidget(parent)
{
    // 1. QTimer连接
    // 2. QTimer启动
}

Widget::~Widget()
{

}

void Widget::initializeGL()
{
    // 1. 花托渲染器实例化    
    // 2. 设置相机的观察点
    
}

void Widget::resizeGL(int w, int h)
{
    // 设置【投影矩阵】，写死就行    
}

void Widget::paintGL()
{
    // 1. #TODO 设置【f】背景底色和深度测试    
    // 2. 设置【视角矩阵】，这里摄像机是固定不动的
    // 3. 设置【变换矩阵】：这里完成了绕轴旋转
    // 4. 将所有3个矩阵和f传入渲染器

}


void Widget::slotTimeout()
{

    // 1. 做自己想要的改变
    // 2. update();，// 在这里触发paintGL()     
}
```

## torusrender.h
```
class TorusRender
{
public:
    // 初始化圆环的尺寸和分割三角形个数    
    void initsize(float rBig,float rSmall,int nCol,int nRow);
    // 渲染函数：将变换运用在花托的着色器程序上
    void render(QOpenGLExtraFunctions *f, QMatrix4x4 &pMatrix, QMatrix4x4 &vMatrix, QMatrix4x4 &mMatrix);

private:
    // 着色器程序
    // VBO对象
    // 顶点坐标序列和纹理坐标坐标序列
    // 纹理指针（不需要）
    // 纹理开关（不需要）
    QOpenGLShaderProgram program_;
    QOpenGLBuffer vbo_;
    QVector<GLfloat> vertPoints_,textPoints_;
    QOpenGLTexture *texture_{nullptr};
    bool userTexture_ = false;
}
```

## torusrender.cpp
```
// 不使用纹理，初始化花托的顶点和VBO
void initsize(float rBig,float rSmall,int nCol,int nRow)
{
    // 1. 编译链接着色器
    // 2. 生成顶点坐标和纹理坐标
    // 3. 创建VBO对象，绑定VBO对象，向VBO的缓冲区传入顶点
}

// 渲染花托
void TorusRender::render(QOpenGLExtraFunctions *f, QMatrix4x4 &pMatrix, QMatrix4x4 &vMatrix, QMatrix4x4 &mMatrix)
{
    // 1. 使用f打开深度测试和GL_CULL_FACE #TODO：GL_CULL_FACE有什么用
    // 2. 设置着色器
    //  2.1. 绑定着色器程序和VBO对象
    //  2.2. 设置着色器的3个矩阵
    //  2.3. 开启着色器的属性0和属性1：顶点坐标和纹理坐标
    //  2.4. 使用f来画出VBO缓冲区的三角形(在这里指定了线框渲染)
    //  2.5. 关闭属性0和属性1
    // 3. 释放vbo和着色器程序
    // 4. 使用f关闭GL_CULL_FACE和深度测试

}
```
